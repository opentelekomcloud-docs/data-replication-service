:original_name: drs_04_0101.html

.. _drs_04_0101:

From DDS to MongoDB
===================

Supported Source and Destination Databases
------------------------------------------

.. table:: **Table 1** Supported Databases

   +------------------------------------------------------------+-------------------------------------------------------------------------------------------------------+
   | Source DB                                                  | Destination DB                                                                                        |
   +============================================================+=======================================================================================================+
   | -  DDS DB instances (versions 3.2, 3.4, 4.0, 4.2, and 4.4) | -  On-premises MongoDB (versions 3.2, 3.4, 3.6, 4.0, 4.2, and 4.4)                                    |
   |                                                            | -  ECS-hosted MongoDB (versions 3.2, 3.4, 3.6, 4.0, 4.2, and 4.4)                                     |
   |                                                            | -  Other cloud MongoDB (versions 3.2, 3.4, 3.6, 4.0, 4.2, and 4.4)                                    |
   |                                                            |                                                                                                       |
   |                                                            |    .. note::                                                                                          |
   |                                                            |                                                                                                       |
   |                                                            |       The destination database version must be the same as or later than the source database version. |
   +------------------------------------------------------------+-------------------------------------------------------------------------------------------------------+

Supported Migration Objects
---------------------------

Different types of migration tasks support different migration objects. For details, see :ref:`Table 2 <drs_04_0101__table9915155511407>`. DRS will automatically check the objects you selected before the migration.

.. _drs_04_0101__table9915155511407:

.. table:: **Table 2** Migration objects

   +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Type                              | Precautions                                                                                                                                                                                                     |
   +===================================+=================================================================================================================================================================================================================+
   | Migration objects                 | -  Object level: table Level, database level, or instance level (full migration).                                                                                                                               |
   |                                   | -  Supported migration objects:                                                                                                                                                                                 |
   |                                   |                                                                                                                                                                                                                 |
   |                                   |    -  Associated objects must be migrated at the same time to avoid migration failure caused by missing associated objects. Common dependencies: collections referenced by views, and views referenced by views |
   |                                   |    -  Replica set: Only collections (including validator and capped collections), indexes, and views can be migrated.                                                                                           |
   |                                   |    -  Cluster: Only collections (including validator and capped collections), shard keys, indexes, and views can be migrated.                                                                                   |
   |                                   |    -  Single node: Only collections (including validator and capped collections), indexes, and views can be migrated.                                                                                           |
   |                                   |    -  System databases (such as local, admin, and config) cannot be migrated. You need to manually create usernames and roles in the destination database.                                                      |
   |                                   |    -  The statement for creating a view cannot contain a regular expression.                                                                                                                                    |
   |                                   |    -  Collections that contain the **\_id** field without indexes are not supported.                                                                                                                            |
   |                                   |    -  The first parameter of **BinData()** cannot be **2**.                                                                                                                                                     |
   |                                   |    -  Do not store non-UTF-8 character strings in the String field of the source database collection. Otherwise, data will be inconsistent before and after the migration.                                      |
   +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Database Account Permission Requirements
----------------------------------------

To start a migration task, the source and destination database users must have permissions listed in the following table. Different types of migration tasks require different permissions. For details, see :ref:`Table 3 <drs_04_0101__en-us_topic_0000001089495445_table68938710614>`. DRS automatically checks the database account permissions in the pre-check phase and provides handling suggestions.

.. _drs_04_0101__en-us_topic_0000001089495445_table68938710614:

.. table:: **Table 3** Database account permission

   +---------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Type                      | Full Migration                                                                                                                                                                | Full+Incremental Migration                                                                                                                               |
   +===========================+===============================================================================================================================================================================+==========================================================================================================================================================+
   | Source database user      | -  Replica set: The source database user must have the readAnyDatabase permission for the admin database.                                                                     | -  Replica set: The source database user must have the readAnyDatabase permission for the admin database and the read permission for the local database. |
   |                           | -  Single node: The source database user must have the readAnyDatabase permission for the admin database.                                                                     | -  Single node: The source database user must have the readAnyDatabase permission for the admin database and the read permission for the local database. |
   |                           | -  Cluster: The source database user must have the readAnyDatabase permission for the admin database and the read permission for the config database.                         |                                                                                                                                                          |
   +---------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Destination database user | The user who connects to the destination database must have the dbAdminAnyDatabase permission of the admin database and the readWrite permission of the destination database. |                                                                                                                                                          |
   |                           |                                                                                                                                                                               |                                                                                                                                                          |
   |                           | If the destination database is a cluster instance, the database user must have the clusterManager permission for the admin database.                                          |                                                                                                                                                          |
   +---------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+

.. note::

   For example, the source database user must have the readAnyDatabase permission for the admin database and the read permission for the config database.

   .. code-block:: text

      db.grantRolesToUser("Username",[{role:"readAnyDatabase",db:"admin"}, {role:"read",db:"config"}])

.. _drs_04_0101__section14377146105411:

Suggestions
-----------

-  The success of database migration depends on environment and manual operations. To ensure a smooth migration, perform a migration trial before you start the migration to help you detect and resolve problems in advance.

-  In the migration, ensure that no data is written to the destination database to ensure data consistency before and after the migration.

-  Start your migration task during off-peak hours. A less active database is easier to migrate successfully. If the data is fairly static, there is less likely to be any severe performance impacts during the migration.

   -  If network bandwidth is not limited, the query rate of the source database increases by about 20 MB/s during full migration, and two to four CPUs are occupied.

   -  If DRS concurrently reads data from a database, it will use about 6 to 10 sessions. The impact of the connections on services must be considered.

-  Data-Level Comparison

   To obtain accurate comparison results, start data comparison at a specified time point during off-peak hours. If it is needed, select **Start at a specified time** for **Comparison Time**. Due to slight time difference and continuous operations on data, data inconsistency may occur, reducing the reliability and validity of the comparison results.

.. _drs_04_0101__section187798577149:

Precautions
-----------

The full+incremental migration process consists of four phases: task startup, full synchronization, incremental synchronization, and task completion. A single full migration task contains three phases. To ensure smooth migration, read the following precautions before creating a migration task.

.. table:: **Table 4** Precautions

   +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Type                              | Restrictions                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
   +===================================+===================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | Starting a task                   | -  **Source database parameter requirements:**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |    -  During an incremental migration, Oplog of the source database must be enabled.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                                   |    -  If the storage space is sufficient, store the source database Oplog for as long as possible. The recommended retention period is three days.                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
   |                                   |    -  If the incremental source data cluster is migrated, the source database balancer must be disabled.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | -  **Source database object requirements:**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |    -  The source database name cannot contain /\\.$ or spaces. The collection name and view name cannot start with **system.** or contain the dollar sign ($).                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   |    -  When multiple source databases are migrated to the same destination database, the name of the database to be migrated must be unique.                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | -  **Destination database parameter requirements:**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |    -  The destination DB instance is running properly.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   |    -  The destination DB instance must have sufficient storage space.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                                   |    -  The version of the destination database instance must be the same as or later than that of the source database.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | -  **Other notes:**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |    -  Associated objects must be migrated at the same time to avoid migration failure caused by missing associated objects. Common dependencies: collections referenced by views, and views referenced by views                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |    -  If a Time-to-Live (TTL) index already exists in the collection of the source database or is created during an incremental migration, data consistency cannot be ensured when source and destination databases are in different time zone.                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |    -  The value of **block_compressor** is determined by **stats().wiredTiger.creationString.block_compressor** of the collection in the source database. If the destination database contains corresponding empty collections, the compression parameters will not be migrated. If the compression parameters in the source database are not supported by the destination database, configure the compression parameters based on **net.compression.compressors** of the destination database. If the storage engine of the destination database is not WiredTiger, DRS does not migrate compression parameters. |
   |                                   |    -  If the destination database is on a replica set instance out of the cloud, enter information about all primary and secondary nodes to reduce the impact of a primary/secondary switchover on the migration task. If you enter information about primary and secondary nodes, ensure that all nodes belong to the same replica set instance.                                                                                                                                                                                                                                                                 |
   |                                   |    -  If the destination database is on a cluster instance out of the cloud, you are advised to enter information about multiple mongos nodes to reduce the impact of the single-node failure on the migration task. In addition, multiple mongos nodes support load balancing. In addition, ensure that all mongos nodes belong to the same cluster instance.                                                                                                                                                                                                                                                    |
   |                                   |    -  To accelerate the migration, delete unnecessary indexes from the source database and retain only necessary indexes before the migration. You are advised not to create indexes for the source database during the migration. If indexes must be created, create them in the background.                                                                                                                                                                                                                                                                                                                     |
   |                                   |    -  To prevent loopback, do not start tasks that migrate the same database to and out of the cloud at the same time.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Full migration                    | -  During task startup and full migration, do not perform DDL operations on the source database. Otherwise, the task may be abnormal.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                                   | -  During migration, do not modify or delete the usernames, passwords, permissions, or ports of the source and destination databases.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                                   | -  During migration, do not modify the destination database (including but not limited to DDL and DML operations) that is being migrated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                                   | -  During the migration, data rollback caused by primary/standby switchover of the source database is not supported.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                                   | -  During the migration, documents larger than 16 MB in the source database cannot be inserted or updated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Incremental migration             | -  During migration, do not modify or delete the usernames, passwords, permissions, or ports of the source and destination databases.                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                                   | -  During migration, do not modify the destination database (including but not limited to DDL and DML operations) that is being migrated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | -  During the migration, data rollback caused by primary/standby switchover of the source database is not supported.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | -  During the migration, documents larger than 16 MB in the source database cannot be inserted or updated.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | -  During an incremental migration of collections, you are advised not to rename the collections.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | -  To ensure the migration performance, concurrent replay is performed at the set level in the incremental task phase. In the following scenarios, only single-thread write is supported and concurrent replay is not supported:                                                                                                                                                                                                                                                                                                                                                                                  |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |    -  The collection index contains a unique key.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
   |                                   |    -  The value of **capped** of the collection attribute is **true**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   |    In either of the preceding scenarios, the task delay may increase.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Precautions for Comparison        | -  You are advised to compare data in the source database during off-peak hours to prevent inconsistent data from being falsely reported and reduce the impact on the source database and DRS tasks.                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                                   | -  During incremental synchronization, if data is written to the source database, the comparison results may be inconsistent.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                                   | -  During row comparison, if an orphan document exists in a cluster instance or chunks are being migrated, the number of returned rows is incorrect and the comparison results are inconsistent. For details, see MongoDB official documents.                                                                                                                                                                                                                                                                                                                                                                     |
   +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Prerequisites
-------------

-  You have logged in to the DRS console.
-  For details about the DB types and versions supported by real-time migration, see :ref:`Real-Time Migration <drs_01_0301>`.

-  You have read :ref:`Suggestions <drs_04_0101__section14377146105411>` and :ref:`Precautions <drs_04_0101__section187798577149>`.

Procedure
---------

This section describes how to migrate from a DDS instance to an on-premises MongoDB database over a public network.

#. On the **Online Migration Management** page, click **Create Migration Task**.
#. On the **Create Replication Instance** page, specify the task name, description, and the replication instance details, and click **Next**.

   -  Task information description

      .. table:: **Table 5** Task information

         +-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Parameter   | Description                                                                                                                                                               |
         +=============+===========================================================================================================================================================================+
         | Region      | The region where the replication instance is deployed. You can change the region. To reduce latency and improve access speed, select the region closest to your services. |
         +-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Project     | The project corresponds to the current region and can be changed.                                                                                                         |
         +-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Task Name   | The task name must start with a letter and consist of 4 to 50 characters. It can contain only letters, digits, hyphens (-), and underscores (_).                          |
         +-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Description | The description consists of a maximum of 256 characters and cannot contain special characters ``!=<>'&"\``                                                                |
         +-------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   -  Replication instance information

      .. table:: **Table 6** Replication instance settings

         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Parameter                         | Description                                                                                                                                                                                                                                                                                                            |
         +===================================+========================================================================================================================================================================================================================================================================================================================+
         | Data Flow                         | Select **Out of the cloud**.                                                                                                                                                                                                                                                                                           |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   | The source database is an RDS database on the current cloud or a DDS DB instance. It is required that either the source database or the destination database is on the current cloud.                                                                                                                                  |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Source DB Engine                  | Select **DDS**.                                                                                                                                                                                                                                                                                                        |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Destination DB Engine             | Select **MongoDB**.                                                                                                                                                                                                                                                                                                    |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Network Type                      | Available options: **Public network**, **VPC**, **VPN or Direct Connect**                                                                                                                                                                                                                                              |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   | -  VPC is suitable for migrations of cloud databases in the same region.                                                                                                                                                                                                                                               |
         |                                   | -  VPN and Direct Connect are suitable for migrations from on-premises databases to cloud databases or between cloud databases across regions.                                                                                                                                                                         |
         |                                   | -  Public network is suitable for migrations from on-premises databases or external cloud databases to destination databases.                                                                                                                                                                                          |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Source DB Instance                | Select the DDS DB instance to be migrated.                                                                                                                                                                                                                                                                             |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Replication Instance Subnet       | The subnet where the replication instance resides. You can also click **View Subnet** to go to the network console to view the subnet where the instance resides.                                                                                                                                                      |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   | By default, the DRS instance and the destination DB instance are in the same subnet. You need to select the subnet where the DRS instance resides, and there are available IP addresses for the subnet. To ensure that the replication instance is successfully created, only subnets with DHCP enabled are displayed. |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Migration Type                    | -  **Full**: This migration type is suitable for scenarios where service interruption is permitted. It migrates all objects and data in non-system databases to the destination database at one time. The objects include collections and indexes.                                                                     |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   |    .. note::                                                                                                                                                                                                                                                                                                           |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   |       If you are performing a full migration, do not perform operations on the source database. Otherwise, data generated in the source database during the migration will not be synchronized to the destination database.                                                                                            |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   | -  **Full+Incremental**: This migration type allows you to migrate data without interrupting services. After a full migration initializes the destination database, an incremental migration initiates and parses logs to ensure data consistency between the source and destination databases.                        |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   | .. note::                                                                                                                                                                                                                                                                                                              |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   |    If you select **Full+Incremental**, data generated during the full migration will be continuously synchronized to the destination database, and the source remains accessible.                                                                                                                                      |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   -  Tags

      .. table:: **Table 7** Tags

         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+
         | Parameter                         | Description                                                                                                                                    |
         +===================================+================================================================================================================================================+
         | Tags                              | -  Tags a task. This configuration is optional. Adding tags helps you better identify and manage your tasks. Each task can have up to 20 tags. |
         |                                   | -  After a task is created, you can view its tag details on the **Tags** tab. For details, see :ref:`Tag Management <drs_online_tag>`.         |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------+

   .. note::

      If a task fails to be created, DRS retains the task for three days by default. After three days, the task automatically ends.

#. On the **Configure Source and Destination Databases** page, wait until the replication instance is created. Then, specify source and destination database information and click **Test Connection** for both the source and destination databases to check whether they have been connected to the replication instance. After the connection tests are successful, select the check box before the agreement and click **Next**.

   .. table:: **Table 8** Source database settings

      +-------------------+--------------------------------------------------------------------------------------------------+
      | Parameter         | Description                                                                                      |
      +===================+==================================================================================================+
      | DB Instance Name  | The DB instance you selected when creating the migration task. This parameter cannot be changed. |
      +-------------------+--------------------------------------------------------------------------------------------------+
      | Database Username | Enter the username of the source database.                                                       |
      +-------------------+--------------------------------------------------------------------------------------------------+
      | Database Password | Enter the password of the source database user.                                                  |
      +-------------------+--------------------------------------------------------------------------------------------------+

   .. note::

      The username and password of the source database are encrypted and stored in the database and the replication instance during the migration. After the task is deleted, the username and password are permanently deleted.

   .. table:: **Table 9** Destination database settings

      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                                                                                                 |
      +===================================+=============================================================================================================================================================================================================================================================================+
      | IP Address or Domain Name         | IP address or domain name of the source database in the **IP address/Domain name:Port** format. The port of the source database. Range: 1 - 65535                                                                                                                           |
      |                                   |                                                                                                                                                                                                                                                                             |
      |                                   | You can enter a maximum of three groups of IP addresses or domain names of the source database. Separate multiple values with commas (,). For example: 192.168.0.1:8080,192.168.0.2:8080. Ensure that the entered IP addresses or domain names belong to the same instance. |
      |                                   |                                                                                                                                                                                                                                                                             |
      |                                   | .. note::                                                                                                                                                                                                                                                                   |
      |                                   |                                                                                                                                                                                                                                                                             |
      |                                   |    If multiple IP addresses or domain names are entered, the test connection is successful as long as one IP address or domain name is accessible. Therefore, you must ensure that the IP address or domain name is correct.                                                |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Authentication Database           | The name of the authentication database. For example: The default authentication database of DDS instance is **admin**.                                                                                                                                                     |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Database Username                 | The username for accessing the destination database.                                                                                                                                                                                                                        |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Database Password                 | The password for the database username.                                                                                                                                                                                                                                     |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | SSL Connection                    | SSL encrypts the connections between the source and destination databases. If SSL is enabled, upload the SSL CA root certificate.                                                                                                                                           |
      |                                   |                                                                                                                                                                                                                                                                             |
      |                                   | .. note::                                                                                                                                                                                                                                                                   |
      |                                   |                                                                                                                                                                                                                                                                             |
      |                                   |    -  The maximum size of a single certificate file that can be uploaded is 500 KB.                                                                                                                                                                                         |
      |                                   |    -  If SSL is disabled, your data may be at risk.                                                                                                                                                                                                                         |
      +-----------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. note::

      The IP address, domain name, username, and password of the destination database are encrypted and stored in DRS and will be cleared after the task is deleted.

#. On the **Set Task** page, select migration objects and click **Next**.

   .. table:: **Table 10** Migrate Object

      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                                                                                                                                                                                    |
      +===================================+================================================================================================================================================================================================================================================================================================================================================================+
      | Flow Control                      | You can choose whether to control the flow.                                                                                                                                                                                                                                                                                                                    |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | -  **Yes**                                                                                                                                                                                                                                                                                                                                                     |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    You can customize the maximum migration speed.                                                                                                                                                                                                                                                                                                              |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    In addition, you can set the time range based on your service requirements. The traffic rate setting usually includes setting of a rate limiting time period and a traffic rate value. Flow can be controlled all day or during specific time ranges. The default value is **All day**. A maximum of three time ranges can be set, and they cannot overlap. |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    The flow rate must be set based on the service scenario and cannot exceed 9,999 MB/s.                                                                                                                                                                                                                                                                       |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | -  **No**                                                                                                                                                                                                                                                                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    The migration speed is not limited and the outbound bandwidth of the source database is maximally used, which will increase the read burden on the source database. For example, if the outbound bandwidth of the source database is 100 MB/s and 80% bandwidth is used, the I/O consumption on the source database is 80 MB/s.                             |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    .. note::                                                                                                                                                                                                                                                                                                                                                   |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |       -  Flow control mode takes effect only during a full migration.                                                                                                                                                                                                                                                                                          |
      |                                   |       -  You can also change the flow control mode after creating a task. For details, see :ref:`Modifying the Flow Control Mode <drs_03_0046>`.                                                                                                                                                                                                               |
      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Other Options                     | Determine whether to migrate the indexes you create during full migration. The default index based on \_id is automatically created in the destination. If indexes are not migrated, the indexes are not compared.                                                                                                                                             |
      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Migrate Object                    | You can choose to migrate all objects, tables, or databases based on your service requirements.                                                                                                                                                                                                                                                                |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | -  **All**: All objects in the source database are migrated to the destination database. After the migration, the object names will remain the same as those in the source database and cannot be modified.                                                                                                                                                    |
      |                                   | -  **Tables**: The selected table-level objects will be migrated.                                                                                                                                                                                                                                                                                              |
      |                                   | -  **Databases**: The selected database-level objects will be migrated.                                                                                                                                                                                                                                                                                        |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | If the source database is changed, click |image1| in the upper right corner before selecting migration objects to ensure that the objects to be selected are from the changed source database.                                                                                                                                                                 |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    -  If you choose not to migrate all of the databases, the migration may fail because the objects, such as stored procedures and views, in the databases to be migrated may have dependencies on other objects that are not migrated. To prevent migration failure, migrate all of the databases.                                                            |
      |                                   |    -  If the object name contains spaces, the spaces before and after the object name are not displayed. If there are multiple spaces between the object name and the object name, only one space is displayed.                                                                                                                                                |
      |                                   |    -  The name of the selected migration object cannot contain spaces.                                                                                                                                                                                                                                                                                         |
      |                                   |    -  To quickly select the desired database objects, you can use the search function.                                                                                                                                                                                                                                                                         |
      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

#. On the **Check Task** page, check the migration task.

   -  If any check fails, review the cause and rectify the fault. After the fault is rectified, click **Check Again**.

      For details about how to handle check items that fail to pass the pre-check, see :ref:`Solutions to Failed Check Items <drs_11_0001>`.

   -  If the check is complete and the check success rate is 100%, click **Next**.

      .. note::

         You can proceed to the next step only when all checks are successful. If there are any items that require confirmation, view and confirm the details first before proceeding to the next step.

#. On the displayed page, specify **Start Time** and confirm that the configured information is correct and click **Submit** to submit the task.

   .. table:: **Table 11** Task startup settings

      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                        |
      +===================================+====================================================================================================================================================================================================+
      | Started Time                      | Set **Start Time** to **Start upon task creation** or **Start at a specified time** based on site requirements. The **Start at a specified time** option is recommended.                           |
      |                                   |                                                                                                                                                                                                    |
      |                                   | .. note::                                                                                                                                                                                          |
      |                                   |                                                                                                                                                                                                    |
      |                                   |    The migration task may affect the performance of the source and destination databases. You are advised to start the task in off-peak hours and reserve two to three days for data verification. |
      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

#. After the task is submitted, view and manage it on the **Online Migration Management** page.

   -  You can view the task status. For more information about task status, see :ref:`Task Statuses <drs_03_0001>`.
   -  You can click |image2| in the upper right corner to view the latest task status.

.. |image1| image:: /_static/images/en-us_image_0000001758549869.png
.. |image2| image:: /_static/images/en-us_image_0000001758429809.png
