:original_name: drs_06_0005.html

.. _drs_06_0005:

Step 1: Create a Synchronization Task
=====================================

Process
-------

A complete real-time synchronization consists of creating a synchronization task, tracking task progress, analyzing synchronization logs, and comparing data consistency. By comparing multiple items and data, you can synchronize data between different service systems in real time.

A complete real-time synchronization involves the following procedures.


.. figure:: /_static/images/en-us_image_0000001391534173.png
   :alt: **Figure 1** Flowchart

   **Figure 1** Flowchart

-  :ref:`Step 1: Create a synchronization task. <drs_06_0005__en-us_topic_0060142340_section52562732171832>` Select the source and destination databases as required and create a synchronization task.

-  :ref:`Step 2: Check the synchronization progress. <drs_10_0007>` During synchronization, you can view the synchronization progress.
-  :ref:`Step 3: View synchronization logs. <drs_10_0008>` Synchronization logs contain alarms, errors, and prompt information. You can analyze system problems based on such information.
-  :ref:`Step 4: Compare synchronization items. <drs_10_0012>` You can compare objects and data to be synchronized to ensure data consistency.

This section describes how to synchronize data from a MySQL database to an RDS MySQL database. To configure other storage engines, you can refer to the following procedures.

Prerequisites
-------------

-  You have logged in to the DRS console.
-  For details about the DB types and versions supported by real-time synchronization, see :ref:`Real-Time Synchronization <drs_01_0302>`.

.. _drs_06_0005__en-us_topic_0060142340_section52562732171832:

Procedure
---------

#. On the **Data Synchronization Management** page, click **Create Synchronization Task**.

#. .. _drs_06_0005__drs_04_0102_en-us_topic_0060142340_li63527764101958:

   On the **Create Synchronization Instance** page, specify the task name, description, and the synchronization instance details, and click **Next**.

   -  Task information description

      .. table:: **Table 1** Task and recipient description

         +-------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
         | Parameter   | Description                                                                                                                                      |
         +=============+==================================================================================================================================================+
         | Region      | The region where the synchronization instance is deployed. You can change the region.                                                            |
         +-------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
         | Project     | The project corresponds to the current region and can be changed.                                                                                |
         +-------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
         | Task Name   | The task name must start with a letter and consist of 4 to 50 characters. It can contain only letters, digits, hyphens (-), and underscores (_). |
         +-------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
         | Description | The description consists of a maximum of 256 characters and cannot contain special characters ``!=<>'&"\``                                       |
         +-------------+--------------------------------------------------------------------------------------------------------------------------------------------------+

   -  Synchronization instance information

      .. table:: **Table 2** Synchronization instance settings

         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Parameter                         | Description                                                                                                                                                                                                                                                                                                            |
         +===================================+========================================================================================================================================================================================================================================================================================================================+
         | Data Flow                         | Select **To the cloud**. The destination database is a database in the current cloud.                                                                                                                                                                                                                                  |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Source DB Engine                  | Select **MySQL**.                                                                                                                                                                                                                                                                                                      |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Destination DB Engine             | Select **MySQL**.                                                                                                                                                                                                                                                                                                      |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Network Type                      | The public network is used as an example.                                                                                                                                                                                                                                                                              |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   | Available options: **Public network**, **VPC**, **VPN or Direct Connect**                                                                                                                                                                                                                                              |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Destination DB Instance           | The RDS DB instance you created.                                                                                                                                                                                                                                                                                       |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   | .. note::                                                                                                                                                                                                                                                                                                              |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   |    -  The destination DB instance cannot be a read replica.                                                                                                                                                                                                                                                            |
         |                                   |    -  The source and destination DB instances can be the same DB instance.                                                                                                                                                                                                                                             |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Synchronization Instance Subnet   | Select the subnet where the synchronization instance is located. You can also click **View Subnet** to go to the network console to view the subnet where the instance resides.                                                                                                                                        |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   | By default, the DRS instance and the destination DB instance are in the same subnet. You need to select the subnet where the DRS instance resides and ensure that there are available IP addresses. To ensure that the synchronization instance is successfully created, only subnets with DHCP enabled are displayed. |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Synchronization Mode              | Available options: **Full+Incremental** and **Incremental**                                                                                                                                                                                                                                                            |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   | -  **Full+Incremental**                                                                                                                                                                                                                                                                                                |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   |    This synchronization mode allows you to synchronize data in real time. After a full synchronization initializes the destination database, an incremental synchronization parses logs to ensure data consistency between the source and destination databases.                                                       |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   |    .. note::                                                                                                                                                                                                                                                                                                           |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   |       If you select **Full+Incremental**, data generated during the full synchronization will be continuously synchronized to the destination database, and the source remains accessible.                                                                                                                             |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   | -  **Incremental**                                                                                                                                                                                                                                                                                                     |
         |                                   |                                                                                                                                                                                                                                                                                                                        |
         |                                   |    Through log parsing, incremental data generated on the source database is synchronized to the destination database.                                                                                                                                                                                                 |
         +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   -  Tags

      .. table:: **Table 3** Tags

         +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+
         | Parameter                         | Description                                                                                                                                     |
         +===================================+=================================================================================================================================================+
         | Tags                              | -  This setting is optional. Adding tags helps you better identify and manage your tasks. Each task can have up to 20 tags.                     |
         |                                   | -  After a task is created, you can view its tag details on the **Tags** tab. For details, see :ref:`Tag Management <drs_synchronization_tag>`. |
         +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------+

   .. note::

      If a task fails to be created, DRS retains the task for three days by default. After three days, the task automatically ends.

#. After the synchronization instance is created, on the **Configure Source and Destination Databases** page, specify source and destination database information. Then, click **Test Connection** for both the source and destination databases to check whether they have been connected to the synchronization instance. After the connection tests are successful, select the check box before the agreement and click **Next**.

   -  Source database information

      .. table:: **Table 4** Source database settings

         +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Parameter                         | Description                                                                                                                                                                                                                                                                                                                                                                                                         |
         +===================================+=====================================================================================================================================================================================================================================================================================================================================================================================================================+
         | IP Address or Domain Name         | The IP address or domain name of the source database.                                                                                                                                                                                                                                                                                                                                                               |
         +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Port                              | The port of the source database. Range: 1 - 65535                                                                                                                                                                                                                                                                                                                                                                   |
         +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Database Username                 | The username for accessing the source database.                                                                                                                                                                                                                                                                                                                                                                     |
         +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Database Password                 | The password for the database username. You can change the password if necessary. To change the password, perform the following operation after the task is created:                                                                                                                                                                                                                                                |
         |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                     |
         |                                   | If the task is in the **Starting**, **Full synchronization**, **Incremental synchronization**, or **Incremental synchronization failed** status, in the **Synchronization Information** area on the **Basic Information** page, click **Update Password** next to the **Source Database Password** field. In the displayed dialog box, change the password. This action only updates DRS with the changed password. |
         +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | SSL Connection                    | SSL encrypts the connections between the source and destination databases. If SSL is enabled, upload the SSL CA root certificate.                                                                                                                                                                                                                                                                                   |
         |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                     |
         |                                   | This parameter is unavailable when the network type is VPC network and the database type is RDS DB instance.                                                                                                                                                                                                                                                                                                        |
         |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                     |
         |                                   | .. note::                                                                                                                                                                                                                                                                                                                                                                                                           |
         |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                     |
         |                                   |    -  The maximum size of a single certificate file that can be uploaded is 500 KB.                                                                                                                                                                                                                                                                                                                                 |
         |                                   |    -  If the SSL certificate is not used, your data may be at risk.                                                                                                                                                                                                                                                                                                                                                 |
         +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

      .. note::

         The IP address, port, username, and password of the source database are encrypted and stored in the database and the synchronization instance, and will be cleared after the task is deleted.

   -  Destination database information

      .. table:: **Table 5** Destination database settings

         +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Parameter                         | Description                                                                                                                                                                                                                                                                                                                                                                                                              |
         +===================================+==========================================================================================================================================================================================================================================================================================================================================================================================================================+
         | DB Instance Name                  | The RDS DB instance selected during synchronization task creation. This parameter cannot be changed.                                                                                                                                                                                                                                                                                                                     |
         +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Database Username                 | The username for accessing the destination database.                                                                                                                                                                                                                                                                                                                                                                     |
         +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
         | Database Password                 | The password for the database username. You can change the password if necessary. To change the password, perform the following operation after the task is created:                                                                                                                                                                                                                                                     |
         |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                          |
         |                                   | If the task is in the **Starting**, **Full synchronization**, **Incremental synchronization**, or **Incremental synchronization failed** status, in the **Synchronization Information** area on the **Basic Information** page, click **Update Password** next to the **Destination Database Password** field. In the displayed dialog box, change the password. This action only updates DRS with the changed password. |
         +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

      .. note::

         The username and password of the destination database are encrypted and stored in the database and the synchronization instance during the synchronization. After the task is deleted, the username and password are permanently deleted.

#. On the **Set Synchronization Task** page, select the conflict policy and synchronization objects, and then click **Next**.

   .. table:: **Table 6** Synchronization mode and object

      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                                                                                                                                                                                    |
      +===================================+================================================================================================================================================================================================================================================================================================================================================================+
      | Flow Control                      | You can choose whether to control the flow.                                                                                                                                                                                                                                                                                                                    |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | -  **Yes**                                                                                                                                                                                                                                                                                                                                                     |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    You can customize the maximum migration speed.                                                                                                                                                                                                                                                                                                              |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    In addition, you can set the time range based on your service requirements. The traffic rate setting usually includes setting of a rate limiting time period and a traffic rate value. Flow can be controlled all day or during specific time ranges. The default value is **All day**. A maximum of three time ranges can be set, and they cannot overlap. |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    The flow rate must be set based on the service scenario and cannot exceed 9,999 MB/s.                                                                                                                                                                                                                                                                       |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | -  **No**                                                                                                                                                                                                                                                                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    The synchronization speed is not limited and the outbound bandwidth of the source database is maximally used, which will increase the read burden on the source database. For example, if the outbound bandwidth of the source database is 100 MB/s and 80% bandwidth is used, the I/O consumption on the source database is 80 MB/s.                       |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    .. note::                                                                                                                                                                                                                                                                                                                                                   |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |       -  The flow control mode takes effect only in the full synchronization phase.                                                                                                                                                                                                                                                                            |
      |                                   |       -  You can also change the flow control mode after creating a task. For details, see :ref:`Modifying the Flow Control Mode <drs_10_0401>`.                                                                                                                                                                                                               |
      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Incremental Conflict Policy       | The conflict policy refers to the conflict handling policy during incremental synchronization. By default, conflicts in the full synchronization phase are ignored. Select any of the following conflict policies:                                                                                                                                             |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | -  Ignore                                                                                                                                                                                                                                                                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    The system will skip the conflicting data and continue the subsequent synchronization process.                                                                                                                                                                                                                                                              |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | -  Report error                                                                                                                                                                                                                                                                                                                                                |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    The synchronization task will be stopped and fail.                                                                                                                                                                                                                                                                                                          |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | -  Overwrite                                                                                                                                                                                                                                                                                                                                                   |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    Conflicting data will be overwritten.                                                                                                                                                                                                                                                                                                                       |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | If data conflicts occur, you can select **Ignore**, **Overwrite**, or **Report error** in any of the following scenarios.                                                                                                                                                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | -  Data exists in the destination database.                                                                                                                                                                                                                                                                                                                    |
      |                                   | -  Multiple source databases are synchronized to one destination database.                                                                                                                                                                                                                                                                                     |
      |                                   | -  Data in the destination database is updated manually.                                                                                                                                                                                                                                                                                                       |
      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Filter DROP DATABASE              | During real-time synchronization, executing DDL operations on the source database may affect the synchronization performance. To reduce the risk of synchronization failure, DRS allows you to filter out DDL operations. Currently, only the delete operations on databases can be filtered by default.                                                       |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | -  If you select **Yes**, the database deletion operation performed on the source database is not synchronized during data synchronization.                                                                                                                                                                                                                    |
      |                                   | -  If you select **No**, related operations are synchronized to the destination database during data synchronization.                                                                                                                                                                                                                                          |
      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Synchronize                       | Normal indexes and incremental DDLs can be synchronized. You can determine whether to synchronize data based on service requirements.                                                                                                                                                                                                                          |
      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Start Point                       | This option is available if you select **Incremental** in :ref:`2 <drs_06_0005__drs_04_0102_en-us_topic_0060142340_li63527764101958>`. The logs of the source database are obtained from the start point during an incremental synchronization.                                                                                                                |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | Run **show master status** to obtain the source database position and set **File**, **Position**, and **Executed_Gtid_Set** as prompted. If **gtid_mode** is disabled, you do not need to specify **Executed_Gtid_Set**.                                                                                                                                       |
      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Synchronization Object            | Select **Tables** or **Databases** as required.                                                                                                                                                                                                                                                                                                                |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | -  If the synchronization objects in source and destination databases have different names, you can map the source object name to the destination one. For details, see :ref:`Mapping Object Names <drs_10_0015>`.                                                                                                                                             |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    If the database table name contains characters other than letters, digits, and underscores (_), or the mapped database table name contains hyphens (-) and number signs (#), the name length cannot exceed 42 characters.                                                                                                                                   |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   | .. note::                                                                                                                                                                                                                                                                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    -  To quickly select the desired database objects, you can use the search function.                                                                                                                                                                                                                                                                         |
      |                                   |    -  If there are changes made to the source databases or objects, click in the upper right corner to update the objects to be synchronized.                                                                                                                                                                                                                  |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                |
      |                                   |    -  If the object name contains spaces, the spaces before and after the object name are not displayed. If there are multiple spaces between the object name and the object name, only one space is displayed.                                                                                                                                                |
      |                                   |    -  The name of the selected synchronization object cannot contain spaces.                                                                                                                                                                                                                                                                                   |
      +-----------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

#. On the **Check Task** page, check the synchronization task.

   -  If any check fails, review the cause and rectify the fault. After the fault is rectified, click **Check Again**.
   -  If all check items are successful, click **Next**.

      .. note::

         You can proceed to the next step only when all checks are successful. If there are any items that require confirmation, view and confirm the details first before proceeding to the next step.

#. On the displayed page, specify **Start Time**, confirm that the configured information is correct, and click **Submit** to submit the task.

   .. table:: **Table 7** Task startup settings

      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                 |
      +===================================+=============================================================================================================================================================================================+
      | Started Time                      | Set **Start Time** to **Start upon task creation** or **Start at a specified time** based on site requirements.                                                                             |
      |                                   |                                                                                                                                                                                             |
      |                                   | .. note::                                                                                                                                                                                   |
      |                                   |                                                                                                                                                                                             |
      |                                   |    After a synchronization task is started, the performance of the source and destination databases may be affected. You are advised to start a synchronization task during off-peak hours. |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

#. After the task is submitted, you can view and manage it on the **Data Synchronization Management** page.

   -  You can view the task status. For more information about task status, see :ref:`Task Statuses <drs_06_0004>`.
   -  You can click |image1| in the upper-right corner to view the latest task status.

.. |image1| image:: /_static/images/en-us_image_0000001341414140.png
