:original_name: drs_11_0442.html

.. _drs_11_0442:

From GaussDB Distributed to GaussDB Distributed
===============================================

Supported Source and Destination Databases
------------------------------------------

.. table:: **Table 1** Supported databases

   +-----------------------------------+----------------------------------------------------------------------------------------------------------+
   | Source DB                         | Destination DB                                                                                           |
   +===================================+==========================================================================================================+
   | -  GaussDB Distributed            | -  GaussDB Distributed                                                                                   |
   |                                   |                                                                                                          |
   |                                   |    .. note::                                                                                             |
   |                                   |                                                                                                          |
   |                                   |       -  The destination database version must be the same as or later than the source database version. |
   +-----------------------------------+----------------------------------------------------------------------------------------------------------+

Supported Synchronization Objects
---------------------------------

:ref:`Table 2 <drs_11_0442__table088143885719>` lists the objects that can be synchronized in different scenarios. DRS will automatically check the objects you selected before the synchronization.

.. _drs_11_0442__table088143885719:

.. table:: **Table 2** Supported synchronization objects

   +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Type                              | Constraints                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
   +===================================+=====================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | Synchronization scope             | -  Instance-level synchronization is not supported. Only one database can be synchronized at a time. To synchronize multiple databases, create multiple tasks.                                                                                                                                                                                                                                                                                                      |
   |                                   | -  **Supported scenarios:** full synchronization, incremental synchronization, and full+incremental synchronization.                                                                                                                                                                                                                                                                                                                                                |
   |                                   | -  **Supported fields:** INTEGER, TINYINT, SMALLINT, BIGINT, NUMBER, NUMERIC, REAL, DOUBLE PRECISION, CHARACTER, CHARACTER VARYING, NVARCHAR2, BIT, BIT VARYING, BLOB, BYTEA, CLOB, RAW, TEXT, JSON, BOOLEAN, DATE, SMALLDATETIME, TIME WITH TIME ZONE, TIME WITHOUT TIME ZONE, TIMESTAMP WITH TIME ZONE, TIMESTAMP WITHOUT TIME ZONE, INTERVAL, BOX, CIDR, CIRCLE, INET, LSEG, MACADDR, MONEY, PATH, POINT, POLYGON, TSQUERY, TSVECTOR, REFCURSOR, UUID and ARRAY. |
   |                                   | -  Table-level synchronization or object file import is supported.                                                                                                                                                                                                                                                                                                                                                                                                  |
   |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   |                                   |    -  During full synchronization, only the structure, sequence, data, constraints, and indexes of the selected table can be synchronized.                                                                                                                                                                                                                                                                                                                          |
   |                                   |    -  During incremental synchronization, only DML statements of selected tables can be synchronized.                                                                                                                                                                                                                                                                                                                                                               |
   |                                   |    -  Databases without schemas cannot be synchronized.                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                                   |    -  Schemas without tables cannot be selected.                                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                                   |    -  Column-store tables, compressed tables, delay tables, and temporary tables cannot be synchronized. Do not synchronize unlogged tables in the incremental phase.                                                                                                                                                                                                                                                                                               |
   |                                   |    -  The database name, schema name, and table name cannot contain special characters **/<.>\\'`|,?!**                                                                                                                                                                                                                                                                                                                                                             |
   |                                   |    -  If you select tables by importing an object file, ensure that the imported table exists in the source database or is visible to the synchronization user.                                                                                                                                                                                                                                                                                                     |
   +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Database User Permission Requirements
-------------------------------------

Before you start a synchronization task, the source and destination database users must meet the requirements in the following table. Different types of synchronization tasks require different permissions. For details, see :ref:`Table 3 <drs_11_0442__table68938710614>`. DRS automatically checks the database account permissions in the pre-check phase and provides handling suggestions.

.. note::

   -  You are advised to create an independent database account for DRS task connection to prevent task failures caused by account modification.
   -  After changing the account passwords for the source or destination databases, :ref:`modify the connection information <drs_10_0016>` in the DRS task as soon as possible to prevent automatic retry after a task failure. Automatic retry will lock the database accounts.

.. _drs_11_0442__table68938710614:

.. table:: **Table 3** Database user permission

   +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Type                      | Full                                                                                                                                                                                                               | Incremental                                                                                                                                                                                                                                                                      | Full+Incremental                                                                                                                                                                                                                                                                 |
   +===========================+====================================================================================================================================================================================================================+==================================================================================================================================================================================================================================================================================+==================================================================================================================================================================================================================================================================================+
   | Source database user      | The user has the sysadmin role or the following minimum permissions:                                                                                                                                               | The user has the sysadmin role or the following minimum permissions:                                                                                                                                                                                                             | The user has the sysadmin role or the following minimum permissions:                                                                                                                                                                                                             |
   |                           |                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                  |
   |                           | -  The CONNECT permission for databases, USAGE permission for schemas, SELECT or UPDATE permission for tables, the UPDATE permission for locking tables without primary keys, and SELECT permission for sequences. | -  The REPLICATION permission or the permission inherited from the built-in role **gs_role_replication**, the CONNECT permission for databases, the USAGE permission for schemas, and the SELECT permission for tables. To compare content, the MONADMIN permission is required. | -  The REPLICATION permission or the permission inherited from the built-in role **gs_role_replication**, the CONNECT permission for databases, the USAGE permission for schemas, and the SELECT permission for tables. To compare content, the MONADMIN permission is required. |
   +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Destination database user | The user has the sysadmin role or the following minimum permissions:                                                                                                                                               | The user has the sysadmin role or the following minimum permissions:                                                                                                                                                                                                             | The user has the sysadmin role or the following minimum permissions:                                                                                                                                                                                                             |
   |                           |                                                                                                                                                                                                                    |                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                  |
   |                           | -  The CONNECT and CREATE permissions for databases, the USAGE and CREATE permissions for schemas, and the INSERT, UPDATE, DELETE, SELECT, ALTER, and INDEX permissions for tables.                                | -  The CONNECT and CREATE permissions for databases, the USAGE and CREATE permissions for schemas, and the INSERT, UPDATE, DELETE, SELECT, ALTER, and INDEX permissions for tables are required. To compare content, the MONADMIN permission is required.                        | -  The CONNECT and CREATE permissions for databases, the USAGE and CREATE permissions for schemas, and the INSERT, UPDATE, DELETE, SELECT, ALTER, and INDEX permissions for tables are required. To compare content, the MONADMIN permission is required.                        |
   +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _drs_11_0442__section1570012154616:

Suggestions
-----------

.. caution::

   -  When a task is being started or in the full synchronization phase, do not perform DDL operations on the source database. Otherwise, the task may be abnormal.
   -  To keep data consistency before and after the synchronization, ensure that no data is written to the destination database during the synchronization.

-  The success of database synchronization depends on environment and manual operations. To ensure a smooth synchronization, perform a synchronization trial before you start the synchronization to help you detect and resolve problems in advance.

-  Start your synchronization task during off-peak hours. A less active database is easier to synchronize successfully. If the data is fairly static, there is less likely to be any severe performance impacts during the synchronization.

   -  If network bandwidth is not limited, the query rate of the source database increases by about 50 MB/s during full synchronization, and two to four CPUs are occupied.
   -  To ensure data consistency, tables to be synchronized without a primary key may be locked for 3s.
   -  The data being synchronized may be locked by other transactions for a long period of time, resulting in read timeout.
   -  When DRS concurrently reads data from a database, it will use about 6 to 10 sessions. The impact of the connections on services must be considered.
   -  If you read a table, especially a large table, during the full migration, the exclusive lock on that table may be blocked.

-  Data-Level Comparison

   To obtain accurate comparison results, start data comparison at a specified time point during off-peak hours. If it is needed, select **Start at a specified time** for **Comparison Time**. Due to slight time difference and continuous operations on data, data inconsistency may occur, reducing the reliability and validity of the comparison results.

.. _drs_11_0442__section449714073815:

Precautions
-----------

The full+incremental synchronization consists of four phases: task startup, full synchronization, incremental synchronization, and task completion. A single full or incremental synchronization task contains three phases. To ensure smooth synchronization, read the following notes before creating a synchronization task.

.. table:: **Table 4** Precautions

   +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Type                              | Constraints                                                                                                                                                                                                                                                                                                                   |
   +===================================+===============================================================================================================================================================================================================================================================================================================================+
   | Starting a task                   | -  **Source database requirements:**                                                                                                                                                                                                                                                                                          |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   |    If incremental synchronization or full+incremental synchronization is selected:                                                                                                                                                                                                                                            |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   |    -  The **wal_level** parameter of the source database is set to **logical**.                                                                                                                                                                                                                                               |
   |                                   |    -  The **enable_slot_log** parameter of the source database is set to **on**.                                                                                                                                                                                                                                              |
   |                                   |    -  The **max_replication_slots** value of the source database must be greater than the number of used replication slots.                                                                                                                                                                                                   |
   |                                   |    -  Add a primary key to the table that does not have a primary key, or set REPLICA IDENTITY to FULL for the table that does not have a primary key.                                                                                                                                                                        |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   | -  **Source database object requirements:**                                                                                                                                                                                                                                                                                   |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   |    -  The names of the source database, schema, and table to be synchronized cannot contain special characters **/<.>\\'`|,?!**                                                                                                                                                                                               |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   | -  **Destination database parameter requirements:**                                                                                                                                                                                                                                                                           |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   |    -  The character set of the destination database must be the same as that of the source database.                                                                                                                                                                                                                          |
   |                                   |    -  Ensure that the source and destination databases are compatible with each other.                                                                                                                                                                                                                                        |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   | -  **Destination database object requirements:**                                                                                                                                                                                                                                                                              |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   |    -  The destination must be a distributed GaussDB instance.                                                                                                                                                                                                                                                                 |
   |                                   |    -  Before the synchronization, ensure that the corresponding database has been created in the destination instance.                                                                                                                                                                                                        |
   |                                   |    -  If you select incremental synchronization, ensure that the table structure of the destination database is the same as that of the source database. If columns are processed in the DRS instance, ensure that the table structure in the destination database is the same as the processed table structure.              |
   |                                   |    -  If you select full or full+incremental synchronization, ensure that the table structure of the destination database is the same as that of the source database. If columns are processed in the DRS instance, ensure that the table structure in the destination database is the same as the processed table structure. |
   |                                   |    -  Triggers enabled in the destination database cannot be associated with synchronization tables.                                                                                                                                                                                                                          |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   | -  **Other notes:**                                                                                                                                                                                                                                                                                                           |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   |    -  SSL is not supported.                                                                                                                                                                                                                                                                                                   |
   |                                   |    -  Cascading one-way synchronization is not supported. For example, data cannot be synchronized from instance A to instance B and then from instance B to instance C.                                                                                                                                                      |
   |                                   |    -  During real-time synchronization, the consistency of distributed transactions is not ensured.                                                                                                                                                                                                                           |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   |    -  After a table is synchronized and renamed, the new index name format is *i_+hash value+original index name (which may be truncated)+_key*. The hash value is calculated based on the *original schema name_original table name_mapped schema name_mapped table name_original index name*                                |
   |                                   |    -  After a table is synchronized and renamed, the new constraint name format is *c_+hash value+original constraint name (which may be truncated)+_key*. The hash value is calculated based on the *original schema name_original table name_mapped schema name_mapped table name_original index name*                      |
   |                                   |    -  GaussDB Distributed supports only ranged partitioned tables. Therefore, other types of partitioned tables are synchronized to the destination database as common tables.                                                                                                                                                |
   |                                   |    -  If a logical replication slot fails to be created or does not exist due to a long transaction, you can reset the task and then restart it.                                                                                                                                                                              |
   +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Full synchronization              | -  Do not change the port of the source and destination databases, or change or delete the passwords and permissions of the source and destination database users. Otherwise, the task may fail.                                                                                                                              |
   |                                   | -  Do not execute any DDL statement in the source database. Restricted by the logical replication function of GaussDB, DDL statements cannot be synchronized. If you synchronize DDL statements, data may be inconsistent or the task may fail.                                                                               |
   |                                   | -  Do not write data to the destination database. Otherwise, data may be inconsistent.                                                                                                                                                                                                                                        |
   +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Incremental synchronization       | -  Do not change the port of the source and destination databases, or change or delete the passwords and permissions of the source and destination database users. Otherwise, the task may fail.                                                                                                                              |
   |                                   | -  Before a task enters the incremental synchronization phase, ensure that long-running transactions are not started in the source database. Starting the long transaction will block the creation of the logical replication slot and cause the task to fail.                                                                |
   |                                   | -  Do not execute any DDL statement in the source database. Restricted by the logical replication function of GaussDB, DDL statements cannot be synchronized. If you synchronize DDL statements, data may be inconsistent or the task may fail.                                                                               |
   |                                   | -  Do not change the REPLICA IDENTITY value of a table in the source database. Otherwise, incremental data may be inconsistent or the task may fail.                                                                                                                                                                          |
   |                                   | -  Do not write data to the destination database. Otherwise, data may be inconsistent.                                                                                                                                                                                                                                        |
   |                                   | -  Replication of interval partition tables is not supported.                                                                                                                                                                                                                                                                 |
   |                                   | -  After a DDL statement is executed in a transaction, the DDL statement and subsequent statements are not decoded.                                                                                                                                                                                                           |
   +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Data processing                   | -  During column processing, the primary key, unique key, and distribution column cannot be filtered out.                                                                                                                                                                                                                     |
   |                                   | -  If table columns are renamed or filtered, the conditional expressions of the partial index in the index definition are ignored, expression columns in common indexes are excluded, and unique indexes that contain expression columns are excluded.                                                                        |
   |                                   | -  If table columns are filtered, the corresponding columns in the common index and foreign key are also filtered.                                                                                                                                                                                                            |
   +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Synchronization comparison        | -  You are advised to compare data in the source database during off-peak hours to prevent inconsistent data from being falsely reported and reduce the impact on the source database and DRS tasks.                                                                                                                          |
   |                                   | -  The topology structure of the source database must be the same as that of the destination database. Otherwise, the content comparison function is unavailable.                                                                                                                                                             |
   |                                   | -  During incremental synchronization, if data is written to the source database, the comparison results may be inconsistent.                                                                                                                                                                                                 |
   |                                   | -  Data cannot be compared during full synchronization.                                                                                                                                                                                                                                                                       |
   |                                   | -  Do not limit the synchronization speed during data comparison.                                                                                                                                                                                                                                                             |
   +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Stopping a task                   | -  **Stop a task normally.**                                                                                                                                                                                                                                                                                                  |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   |    After an incremental or full+incremental synchronization is complete, the streaming replication slot created by the task in the source database is automatically deleted.                                                                                                                                                  |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   | -  **Forcibly stop a task.**                                                                                                                                                                                                                                                                                                  |
   |                                   |                                                                                                                                                                                                                                                                                                                               |
   |                                   |    To forcibly stop an incremental or a full+incremental synchronization task, delete the replication slots that may remain in the source database. For details, see :ref:`Forcibly Stopping Synchronization from GaussDB Distributed <drs_03_1131>`.                                                                         |
   +-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Prerequisites
-------------

-  You have logged in to the DRS console.
-  For details about the DB types and versions supported by real-time synchronization, see :ref:`Real-Time Synchronization <drs_01_0302>`.

-  You have read :ref:`Suggestions <drs_11_0442__section1570012154616>` and :ref:`Precautions <drs_11_0442__section449714073815>`.

Procedure
---------

#. On the **Data Synchronization Management** page, click **Create Synchronization Task**.

#. .. _drs_11_0442__en-us_topic_0288918853_li125644351372:

   On the **Create Synchronization Instance** page, specify the task name, description, and the synchronization instance details, and click **Next**.

   .. table:: **Table 5** Task and recipient description

      +-------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter   | Description                                                                                                                                      |
      +=============+==================================================================================================================================================+
      | Region      | The region where the synchronization instance is deployed. You can change the region.                                                            |
      +-------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
      | Project     | The project corresponds to the current region and can be changed.                                                                                |
      +-------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
      | Task Name   | The task name must start with a letter and consist of 4 to 50 characters. It can contain only letters, digits, hyphens (-), and underscores (_). |
      +-------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
      | Description | The description consists of a maximum of 256 characters and cannot contain special characters ``!=<>'&"\``                                       |
      +-------------+--------------------------------------------------------------------------------------------------------------------------------------------------+

   .. table:: **Table 6** Synchronization instance settings

      +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                                                                                      |
      +===================================+==================================================================================================================================================================================================================================================================+
      | Data Flow                         | Select **Out of the cloud**.                                                                                                                                                                                                                                     |
      +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Source DB Engine                  | Select **GaussDB Distributed**.                                                                                                                                                                                                                                  |
      +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Destination DB Engine             | Select **GaussDB Distributed**.                                                                                                                                                                                                                                  |
      +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Network Type                      | The public network is used as an example. Available options: **VPC**, **Public network** and **VPN or Direct Connect**                                                                                                                                           |
      +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Source DB Instance                | The distributed GaussDB instance you created.                                                                                                                                                                                                                    |
      +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Synchronization Mode              | Available options: **Full+Incremental**, **Full**, and **Incremental**. Full+Incremental is used as an example.                                                                                                                                                  |
      |                                   |                                                                                                                                                                                                                                                                  |
      |                                   | -  **Full+Incremental**                                                                                                                                                                                                                                          |
      |                                   |                                                                                                                                                                                                                                                                  |
      |                                   |    This synchronization mode allows you to synchronize data in real time. After a full synchronization initializes the destination database, an incremental synchronization parses logs to ensure data consistency between the source and destination databases. |
      |                                   |                                                                                                                                                                                                                                                                  |
      |                                   |    .. note::                                                                                                                                                                                                                                                     |
      |                                   |                                                                                                                                                                                                                                                                  |
      |                                   |       If you select **Full+Incremental**, data generated during the full synchronization will be continuously synchronized to the destination database, and the source remains accessible.                                                                       |
      |                                   |                                                                                                                                                                                                                                                                  |
      |                                   | -  **Full**                                                                                                                                                                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                  |
      |                                   |    In this mode, data is synchronized from the source to the destination at a time.                                                                                                                                                                              |
      |                                   |                                                                                                                                                                                                                                                                  |
      |                                   | -  **Incremental**                                                                                                                                                                                                                                               |
      |                                   |                                                                                                                                                                                                                                                                  |
      |                                   |    Through log parsing, incremental data generated on the source database is synchronized to the destination database.                                                                                                                                           |
      +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Specifications                    | DRS instance specifications. Different specifications have different performance upper limits. For details, see :ref:`Real-Time Synchronization <drs_01_0314>`.                                                                                                  |
      +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Tags                              | -  This setting is optional. Adding tags helps you better identify and manage your tasks. Each task can have up to 20 tags.                                                                                                                                      |
      |                                   | -  After a task is created, you can view its tag details on the **Tags** tab. For details, see :ref:`Tag Management <drs_synchronization_tag>`.                                                                                                                  |
      +-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. note::

      If a task fails to be created, DRS retains the task for three days by default. After three days, the task automatically ends.

#. On the **Configure Source and Destination Databases** page, wait until the synchronization instance is created. Then, specify source and destination database information and click **Test Connection** for both the source and destination databases to check whether they have been connected to the synchronization instance. After the connection tests are successful, click **Next**.

   Establish the connectivity between the DRS instance and the source and destination databases.

   -  **Network connectivity:** Ensure that the source and destination databases accept connections from the DRS instance.
   -  **Account connectivity:** Ensure that the source and destination databases allows connections from the DRS instance using the username and password.

   .. table:: **Table 7** Source database settings

      +-------------------+-------------------------------------------------------------------------------------------------------------------+
      | Parameter         | Description                                                                                                       |
      +===================+===================================================================================================================+
      | DB Instance Name  | The distributed GaussDB instance selected during synchronization task creation. This parameter cannot be changed. |
      +-------------------+-------------------------------------------------------------------------------------------------------------------+
      | Database Username | The username for accessing the source database.                                                                   |
      +-------------------+-------------------------------------------------------------------------------------------------------------------+
      | Database Password | The password for the database username.                                                                           |
      +-------------------+-------------------------------------------------------------------------------------------------------------------+

   .. note::

      The username and password of the source database are encrypted and stored in the database and the synchronization instance during the synchronization. After the task is deleted, the username and password are permanently deleted.

   .. table:: **Table 8** Destination database settings

      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                     |
      +===================================+=================================================================================================================================================================================+
      | IP Address or Domain Name         | IP address or domain name of the destination database in the **IP address/Domain name:Port** format. The port of the destination database. Range: 1 - 65535                     |
      |                                   |                                                                                                                                                                                 |
      |                                   | You can enter up to 10 groups of IP addresses or domain names of the source database. Separate multiple values with commas (,). For example: 192.168.0.1:8080,192.168.0.2:8080. |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Database Username                 | The username for accessing the destination database.                                                                                                                            |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Database Password                 | The password for the database username.                                                                                                                                         |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. note::

      The username and password of the destination database are encrypted and stored in the database and the synchronization instance during the synchronization. After the task is deleted, the username and password are permanently deleted.

#. On the **Set Synchronization Task** page, select the synchronization policy and synchronization objects, and click **Next**.

   .. table:: **Table 9** Synchronization Object

      +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
      +===================================+========================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
      | Flow Control                      | You can choose whether to control the flow.                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   | -  **Yes**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |    You can customize the maximum migration speed.                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |    In addition, you can set the time range based on your service requirements. The traffic rate setting usually includes setting of a rate limiting time period and a traffic rate value. Flow can be controlled all day or during specific time ranges. The default value is **All day**. A maximum of three time ranges can be set, and they cannot overlap.                                                                                                                                         |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |    The flow rate must be set based on the service scenario and cannot exceed 9,999 MB/s.                                                                                                                                                                                                                                                                                                                                                                                                               |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   | -  **No**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |    The synchronization speed is not limited and the outbound bandwidth of the source database is maximally used, which will increase the read burden on the source database. For example, if the outbound bandwidth of the source database is 100 MB/s and 80% bandwidth is used, the I/O consumption on the source database is 80 MB/s.                                                                                                                                                               |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |    .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |       -  The flow control mode takes effect only in the full synchronization phase.                                                                                                                                                                                                                                                                                                                                                                                                                    |
      |                                   |       -  You can also change the flow control mode after creating a task. For details, see :ref:`Modifying the Flow Control Mode <drs_10_0401>`.                                                                                                                                                                                                                                                                                                                                                       |
      +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Incremental Conflict Policy       | The conflict policy refers to the conflict handling policy during incremental synchronization. By default, conflicts in the full synchronization phase are ignored.                                                                                                                                                                                                                                                                                                                                    |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   | The following conflict policies are supported:                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   | -  Ignore                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |    The system will skip the conflicting data and continue the subsequent synchronization process.                                                                                                                                                                                                                                                                                                                                                                                                      |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   | -  Overwrite                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |    Conflicting data will be overwritten.                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   | -  Report error                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |    The synchronization task will be stopped and fail.                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   | Ignore and overwrite: Synchronization stability is prioritized, so tasks will not be interrupted as data conflicts occur.                                                                                                                                                                                                                                                                                                                                                                              |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   | Report error: Data quality is prioritized. Any data conflicts are not allowed, so once a conflict occurs, the synchronization task fails and an error is reported. You need to manually find the cause of the fault. If the task is in the failed state for a long time, the storage space may be used up and the task cannot be restored.                                                                                                                                                             |
      +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Synchronization Object            | Select **Tables** or **Import object file** based on your service requirements.                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   | -  If the synchronization objects in source and destination databases have different names, you can map the source object name to the destination one. For details, see :ref:`Changing Object Names (Mapping Object Names) <drs_10_0015>`.                                                                                                                                                                                                                                                             |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |    When you map a schema name or table name to the target object, name the indexes and constraints of the mapped table in the following format: prefix + full name-based hash value + original index/constraint name + \_key to prevent index/constraint name conflicts. The prefix of the index is ``i_``, the prefix of the constraint is ``c_``, and the full name is "schema name_table name_index/constraint name". The original index/constraint name may be truncated due to length limitation. |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   | -  You can change object names when you select **Import object file**. For details, see :ref:`Importing Synchronization Objects <drs_10_0402>`.                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |    .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |       -  You can search for table names to quickly select the required database objects.                                                                                                                                                                                                                                                                                                                                                                                                               |
      |                                   |       -  If there are changes made to the source databases or objects, click in the upper right corner to update the objects to be synchronized.                                                                                                                                                                                                                                                                                                                                                       |
      |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
      |                                   |       -  If an object name contains spaces, the spaces before and after the object name are not displayed. If there are two or more consecutive spaces in the middle of the object name, only one space is displayed.                                                                                                                                                                                                                                                                                  |
      |                                   |       -  The name of the selected synchronization object cannot contain spaces.                                                                                                                                                                                                                                                                                                                                                                                                                        |
      +-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

#. On the **Advanced Settings** page, set the parameters for full+incremental synchronization selected in :ref:`2 <drs_11_0442__en-us_topic_0288918853_li125644351372>` and click **Next**.

   .. table:: **Table 10** Full synchronization settings

      +-----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter                   | Description                                                                                                                                                                               | Default Value         |
      +=============================+===========================================================================================================================================================================================+=======================+
      | Synchronization Object Type | Select whether to synchronize indexes based on the service requirements. Table structure and data are mandatory.                                                                          | All options           |
      +-----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Concurrent Export Tasks     | Number of export threads. Value range: 1 to 16. A larger value indicates higher load on the source database.                                                                              | 8                     |
      +-----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Concurrent Import Tasks     | Number of import threads. Value range: 1 to 16. A larger value indicates higher load on the destination database.                                                                         | 8                     |
      +-----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Rows per Shard              | Value range: 0 or 520,000 to 1,000,000,000                                                                                                                                                | 520000                |
      |                             |                                                                                                                                                                                           |                       |
      |                             | -  **0**                                                                                                                                                                                  |                       |
      |                             |                                                                                                                                                                                           |                       |
      |                             |    All tables are not sharded, and each table is synchronized as a whole.                                                                                                                 |                       |
      |                             |                                                                                                                                                                                           |                       |
      |                             | -  Other values                                                                                                                                                                           |                       |
      |                             |                                                                                                                                                                                           |                       |
      |                             |    The table is sharded based on the specified value (or the primary key column). If the number of records in a table is less than the value of this parameter, the table is not sharded. |                       |
      +-----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

   .. table:: **Table 11** Incremental synchronization settings

      +-------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+
      | Parameter               | Description                                                                                                                                                                                                 | Default Value |
      +=========================+=============================================================================================================================================================================================================+===============+
      | Concurrent Replay Tasks | Number of concurrent threads for data replay. Value range: 1 to 64. Incremental data is concurrently written to the destination database. A larger value indicates higher load on the destination database. | 64            |
      +-------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+

#. On the **Check Task** page, check the synchronization task.

   -  If any check fails, review the cause and rectify the fault. After the fault is rectified, click **Check Again**.
   -  If all check items are successful, click **Next**.

      .. note::

         You can proceed to the next step only when all checks are successful. If there are any items that require confirmation, view and confirm the details first before proceeding to the next step.

#. On the **Confirm Task** page, specify **Start Time**, confirm that the configured information is correct, and click **Submit** to submit the task.

   .. table:: **Table 12** Task startup settings

      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter                         | Description                                                                                                                                                                                 |
      +===================================+=============================================================================================================================================================================================+
      | Started Time                      | Set **Start Time** to **Start upon task creation** or **Start at a specified time** based on site requirements.                                                                             |
      |                                   |                                                                                                                                                                                             |
      |                                   | .. note::                                                                                                                                                                                   |
      |                                   |                                                                                                                                                                                             |
      |                                   |    After a synchronization task is started, the performance of the source and destination databases may be affected. You are advised to start a synchronization task during off-peak hours. |
      +-----------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

#. After the task is submitted, you can view and manage it on the **Data Synchronization Management** page.

   -  You can view the task status. For more information about task status, see :ref:`Task Statuses <drs_06_0004>`.
   -  You can click |image1| in the upper-right corner to view the latest task status.
   -  By default, DRS retains a task in the **Configuration** state for three days. After three days, DRS automatically deletes background resources, but the task status remains unchanged. When you reconfigure the task, DRS applies for resources for the task again.

.. |image1| image:: /_static/images/en-us_image_0000001758549405.png
